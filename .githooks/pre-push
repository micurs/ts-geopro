#!/bin/sh

# Pre-push hook to run build, lint, and test before pushing
# This hook prevents pushing if any of these steps fail

echo "ğŸ”¨ Running pre-push checks..."
echo ""

# Get the project root directory (where package.json is located)
PROJECT_ROOT="$(git rev-parse --show-toplevel)"
cd "$PROJECT_ROOT" || exit 1

# Run build
echo "ğŸ“¦ Building project..."
if ! pnpm run build; then
    echo "âŒ Build failed. Push aborted."
    exit 1
fi
echo "âœ… Build successful"
echo ""

# Run lint
echo "ğŸ” Linting code..."
if ! pnpm run lint; then
    echo "âŒ Lint failed. Push aborted."
    exit 1
fi
echo "âœ… Lint passed"
echo ""

# Run tests
echo "ğŸ§ª Running tests..."
if ! pnpm run test; then
    echo "âŒ Tests failed. Push aborted."
    exit 1
fi
echo "âœ… Tests passed"
echo ""

echo "âœ¨ All pre-push checks passed! Proceeding with push..."
exit 0

